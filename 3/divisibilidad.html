<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Divisibilidad - Guía de Programacion Competitiva</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../preface.html"><strong aria-hidden="true">1.</strong> Prefacio</a></li><li class="chapter-item expanded "><a href="../introduction_1.html"><strong aria-hidden="true">2.</strong> Introducción</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../2/2.1.html"><strong aria-hidden="true">2.1.</strong> Lenguajes de programación</a></li><li class="chapter-item expanded "><a href="../2/2.2.html"><strong aria-hidden="true">2.2.</strong> Entrada y salida</a></li><li class="chapter-item expanded "><a href="../2/2.3.html"><strong aria-hidden="true">2.3.</strong> Números y cómo representarlos</a></li><li class="chapter-item expanded "><a href="../2/2.4.html"><strong aria-hidden="true">2.4.</strong> Template de C++</a></li><li class="chapter-item expanded "><a href="../2/2.5.html"><strong aria-hidden="true">2.5.</strong> Cómo Practicar</a></li><li class="chapter-item expanded "><a href="../2/2.6.html"><strong aria-hidden="true">2.6.</strong> Problemas Introductorios</a></li></ol></li><li class="chapter-item expanded "><a href="../3/Introduccion.html"><strong aria-hidden="true">3.</strong> Matemáticas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../3/divisibilidad.html" class="active"><strong aria-hidden="true">3.1.</strong> Divisibilidad</a></li><li class="chapter-item expanded "><a href="../3/modular.html"><strong aria-hidden="true">3.2.</strong> Aritmética Modular</a></li><li class="chapter-item expanded "><a href="../3/combi.html"><strong aria-hidden="true">3.3.</strong> Combinatoria</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Guía de Programacion Competitiva</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="divisibilidad"><a class="header" href="#divisibilidad">Divisibilidad</a></h1>
<blockquote>
<p>Importancia: <font color="green">Alta</font></p>
</blockquote>
<center><i>Los primos son legos</i></center>
<h2 id="primos"><a class="header" href="#primos">Primos</a></h2>
<blockquote>
<p>Importancia: <font color="green">Alta</font></p>
</blockquote>
<p>Un entero positivo \(a\) es divisor o factor de un entero \(b\), si \(b\) es divisible por \(a\), lo que implica que existe un entero \(k\) tal que \(b = ka\). Un entero \(n &gt; 1\) es primo si sus únicos divisores son \(1\) y \(n\). Los enteros mayores que \(1\) y que no son primos son llamados compuestos.</p>
<p>Cualquier entero positivo tiene una única factorización prima, una forma de descomponerlo como una multiplicación de primos, de la siguiente forma</p>
<p>$$n = {p_1}^{a_1} {p_2}^{a_2} \cdots {p_k}^{a_k}$$</p>
<p>Donde \(p_i\) son primos diferentes y las \(a_i\) son enteros positivos.</p>
<h3 id="algoritmo-factorización-de-primos-singular"><a class="header" href="#algoritmo-factorización-de-primos-singular"><strong>Algoritmo:</strong> Factorización de Primos (singular)</a></h3>
<pre><code class="language-cpp">vi factor(tint n) {
    vi ret;
    forsn(i, 2, sqrt(n)+1) 
    {
        while (n % i == 0) 
        {
            ret.push_back(i);
            n /= i;
        }
    }
    if (n &gt; 1)
        ret.push_back(n);
    return ret;
}
</code></pre>
<ul>
<li>Memoria: \( \Theta(1) \)</li>
<li>Complejidad \( \Theta(\sqrt{n}) \)</li>
</ul>
<p>Este algoritmo tiene complejidad \(\Theta(\sqrt{n})\), ya que iteramos por los factores \(i \leq \sqrt{n}\). Podría resultar confuso que quede está complejidad, siendo que tenemos un while adentro del for, pero como este se encarga de dividir a \(n\), está acelerando el código.</p>
<h3 id="algoritmo-criba-de-eratóstenes"><a class="header" href="#algoritmo-criba-de-eratóstenes"><strong>Algoritmo:</strong> Criba de Eratóstenes</a></h3>
<p>Ahora sabemos cómo encontrar la descomposición en primos de un número. Pero ¿cómo hacemos para encontrar a todos los primos menores a un número arbitrario \(n\)? podríamos implementar una función <strong>es_primo(n)</strong> que funcione en \(\Theta(\sqrt{n})\) y simplemente iterar por los números entre 1 y \(n\), llamando a esta función por cada numero. La complejidad seria \(\Theta(n \sqrt{n})\). Resulta que podemos resolver este problema en tan solo \(\Theta (n\log(n))\).</p>
<pre><code class="language-cpp">tint n;
vector&lt;bool&gt; is_prime(n+1, 1);
is_prime[0] = is_prime[1] = false;
forsn(i, 2, n+1) 
    if (is_prime[i])// si i es primo
        for (tint j = i * 2; j &lt;= n; j += i)
            is_prime[j] = false; //pinto a todos los a * i como compuestos
</code></pre>
<ul>
<li>Memoria: \( \Theta(1) \)</li>
<li>Complejidad \( \Theta(n \log(n)) \)</li>
</ul>
<p>La magia está en la serie armónica:</p>
<blockquote>
<p><strong>Serie armónica</strong> \(\sum_{i = 0}^{n}\frac{1}{i} = H_n \sim \Theta(\log(n))\)</p>
</blockquote>
<p>A lo sumo iteramos \(\frac{n}{i}\) veces por cada número (el número es menor ya que no iteramos por los compuestos). Entonces queda claro que la complejidad está acotada por \(\mathcal{O}(n\log n)\).</p>
<h3 id="algoritmo-factorización-de-primos-plural"><a class="header" href="#algoritmo-factorización-de-primos-plural"><strong>Algoritmo:</strong> Factorización de Primos (plural)</a></h3>
<p>El algoritmo de factorización singular mencionado anteriormente es óptimo para encontrar la factorización de un número en particular, pero ¿qué pasa si necesitamos saber la factorización de \(n\) números?. Resulta tentador responder que podemos usar el algoritmo \(n\) veces, y es verdad... pero no es óptimo. Si hiciéramos esto nos quedaría un código con complejidad \(\Theta(n\sqrt{M})\), donde M es el máximo valor que puede tomar alguno de nuestros números. Esta complejidad no es muy buena. ¿Cómo podemos usar la <strong>criba de Eratóstenes</strong> para mejorar la complejidad?</p>
<details>
  <summary>Pista </summary>
<p>Asumamos que tenemos precomputados los primos del 1 al \(n\), podemos mejorar nuestro algoritmo de factorización?</p>
</details>
<details>
  <summary>Respuesta a la pista </summary>
<p>En vez de iterar por todos los enteros menores a \(\sqrt{n}\), podemos iterar por todos los primos menores a \(\sqrt{n}\).</p>
</details>
<pre><code class="language-cpp">vi factor(tint n) {
    vi ret;
    for(auto &amp;i:primos) 
    {
        if(i * i &gt; n)// me pase de largo
            break;
        while (n % i == 0) 
        {
            ret.push_back(i);
            n /= i;
        }
    }
    if (n &gt; 1)
        ret.push_back(n);
    return ret;
}
</code></pre>
<ul>
<li>Memoria: \(\Theta(1)\)</li>
<li>Complejidad: \(\Theta(log(n))\)</li>
</ul>
<p>Si repetimos este proceso para los \(n\) números, nos queda \( \Theta(n\log n)\) de preprocesamiento (criba) y \( \Theta(n\log n)\) de factorizar a todos los números, buenísimo.</p>
<h3 id="cantidad-de-divisores"><a class="header" href="#cantidad-de-divisores">Cantidad de divisores</a></h3>
<blockquote>
<p>Importancia: <font color="yellow">Media</font></p>
</blockquote>
<p>Sabemos que
$$n = {p_1}^{a_1} {p_2}^{a_2} \cdots {p_k}^{a_k}$$</p>
<p>Ahora vemos que cada divisor \(d\) de un numero \(n\) puede ser pensado como un subconjunto de los primos que lo componen. Por ejemplo, 6 y 4 son divisores de 12 ya que:
$$12 = 2^2 \cdot 3^1 $$
$$6 = 2^1 \cdot 3^1$$
$$4 = 2^2$$</p>
<p>Cada divisor, entonces, puede ser expresado con un conjunto de exponentes asociados a los primos de la descomposición de \(n\).</p>
<p>$$12 = \text{{2, 1}}$$
$$6 = \text{{1, 1}}$$
$$4 = \text{{2, 0}}$$</p>
<p>De esto sale que la contar la cantidad de divisores equivale a contar la cantidad de representaciones de este tipo. Cada posición puede tomar un valor en el rango \([0, a_i]\). Por lo tanto, la cantidad de divisores es</p>
<p>$$\prod_{i = 1}^{\text{k}} (a_i + 1) $$</p>
<h2 id="gcd-y-lcm"><a class="header" href="#gcd-y-lcm">GCD y LCM</a></h2>
<blockquote>
<p>Importancia: <font color="green">Alta</font></p>
</blockquote>
<p>En varias ocasiones es útil recordar las operaciones de <strong>GCD</strong> y <strong>LCM</strong> cuando trabajamos con enteros. Por ahora simplemente se dan las definiciones:</p>
<ul>
<li><strong>gcd(a, b)</strong>: <em>Greatest Common Divisor</em>, el entero mas grande que divide tanto a \(a\) como a \(b\). Si <strong>gcd(a, b) == 1</strong> se dice <em>"a y b son coprimos"</em>.</li>
<li><strong>lcm(a, b) = a*b/gcd(a, b)</strong></li>
</ul>
<blockquote>
<p>Nota: a partir de C++17 <strong>gcd</strong> es una operación incluida en la librería estándar, es decir, se puede hacer <strong>gcd(a, b)</strong> sin necesidad de incluir código extra.</p>
</blockquote>
<h2 id="phi-de-euler"><a class="header" href="#phi-de-euler">Phi de Euler</a></h2>
<blockquote>
<p>Importancia: <font color="red">Baja</font></p>
</blockquote>
<p>próximamente</p>
<h2 id="problemas"><a class="header" href="#problemas">Problemas</a></h2>
<ul>
<li><a href="https://cses.fi/problemset/task/1713">Counting Divisors</a></li>
<li><a href="https://cses.fi/problemset/task/1081">Common Divisors</a></li>
<li><a href="https://cses.fi/problemset/task/1082">Sum of Divisors</a></li>
<li><a href="https://cses.fi/problemset/task/2182">Divisor Analysis</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../3/Introduccion.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../3/modular.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../3/Introduccion.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../3/modular.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
